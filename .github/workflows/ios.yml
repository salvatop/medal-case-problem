name: iOS Build and Test

on:
  push:
    branches:
      - main
  pull_request:
    branches:
      - main
jobs:
  build-and-test:
    runs-on: macos-latest

    steps:
    - name: Checkout Code
      uses: actions/checkout@v4

    - name: Set up Xcode
      with:
        xcode-version: "16.0"

    - name: Install Dependencies
      run: |
        if [ -f "Podfile" ]; then
          sudo gem install cocoapods
          pod install
        fi

    - name: Build and Test
      run: |
        xcodebuild test \
          -workspace medal-case-problem.xcodeproj \
          -scheme medal-case-problem \ 
          -sdk iphonesimulator \
          -destination 'platform=iOS Simulator,name=iPhone 16,OS=18.0' | xcpretty
      env:
        XCODE_XCCONFIG_FILE: ""
